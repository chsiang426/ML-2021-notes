<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>06-Generative Adversarial Network（GAN）</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(128, 125, 120, 1);
	fill: rgba(128, 125, 120, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(204, 121, 47, 1);
	fill: rgba(204, 121, 47, 1);
}
.highlight-yellow {
	color: rgba(195, 148, 67, 1);
	fill: rgba(195, 148, 67, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(63, 126, 190, 1);
	fill: rgba(63, 126, 190, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(179, 84, 136, 1);
	fill: rgba(179, 84, 136, 1);
}
.highlight-red {
	color: rgba(201, 85, 73, 1);
	fill: rgba(201, 85, 73, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 111, 200, 0.09);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(128, 125, 120, 1);
	fill: rgba(128, 125, 120, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(204, 121, 47, 1);
	fill: rgba(204, 121, 47, 1);
}
.block-color-yellow {
	color: rgba(195, 148, 67, 1);
	fill: rgba(195, 148, 67, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(63, 126, 190, 1);
	fill: rgba(63, 126, 190, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(179, 84, 136, 1);
	fill: rgba(179, 84, 136, 1);
}
.block-color-red {
	color: rgba(201, 85, 73, 1);
	fill: rgba(201, 85, 73, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(232, 242, 250, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 99, 174, 0.172); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	


/* Back-to-index button */
.floating-button {
	display: inline-flex;
	align-items: center;
	gap: 0.4em;
	padding: 0.55em 1.15em;
	border-radius: 999px;
	background: rgba(255, 255, 255, 0.92);
	color: #1f2933;
	font-size: 0.9rem;
	font-weight: 500;
	text-decoration: none;
	border: 1px solid rgba(15, 23, 42, 0.12);
	box-shadow: 0 8px 24px rgba(15, 23, 42, 0.12);
	backdrop-filter: blur(12px);
	transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
}
.floating-button:hover {
	background: #1f2933;
	color: #ffffff;
	box-shadow: 0 12px 32px rgba(15, 23, 42, 0.18);
	transform: translateY(-1px);
}
.floating-button:active {
	transform: translateY(0);
	box-shadow: 0 6px 18px rgba(15, 23, 42, 0.14);
}
.back-to-index {
	position: fixed;
	top: 20px;
	left: 20px;
	z-index: 1000;
}
.nav-controls {
	position: fixed;
	top: 20px;
	right: 20px;
	z-index: 1000;
	display: inline-flex;
	gap: 0.6em;
	flex-wrap: wrap;
	justify-content: flex-end;
}
@media (max-width: 600px) {
	.back-to-index {
		top: 16px;
		left: 16px;
	}
	.nav-controls {
		top: 16px;
		right: 16px;
		gap: 0.5em;
	}
	.floating-button {
		padding: 0.45em 1em;
		font-size: 0.85rem;
	}
}
@media print {
	.back-to-index,
	.nav-controls {
		display: none;
	}
}

</style></head><body>
<a class="floating-button back-to-index" href="../index.html">回到目錄</a>
<div class="nav-controls">
	<a class="floating-button nav-button" href="../05-Transformer/05-Transformer.html" title="上一節：05-Transformer">上一節</a>
	<a class="floating-button nav-button" href="../07-Self-Supervised Learning（BERT）/07-Self-Supervised Learning（BERT）.html" title="下一節：07-Self-Supervised Learning（BERT）">下一節</a>
</div>
<article id="3eef1d4d-3438-4ea5-96d6-be37eb429a25" class="page sans"><header><div class="page-header-icon undefined"><img class="icon notion-static-icon" src="https://www.notion.so/icons/document_blue.svg"/></div><h1 class="page-title">06-<strong>Generative Adversarial Network</strong>（GAN）</h1><p class="page-description"></p><table class="properties"><tbody></tbody></table></header><div class="page-body"><nav id="e93d2faa-8357-423d-a91a-a85a162d3ea9" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#1f62f0f0-09b2-4f48-b142-fa2eb2d1599d">1. <strong>基本概念</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#80372bef-4cff-4ace-ac49-78f9a0136956">2. Generative Adversarial Network<strong>（GAN）</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#68a63857-117d-4d1a-be3f-6c7b9e2f2275">2.1 Unconditional Generation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#282786b4-7c98-4399-8e5a-98ce030fd735">2.2 Discriminator</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#06ea5c7f-2b46-4165-bf49-48a0b041646b">2.3 Algorithm</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5faa094e-b15c-4c38-91bf-824a4585cf09">2.4 實例</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#959d1f07-d859-4500-9d71-cad2dd366cb2">2.4.1 Anime Face Generation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#3413c9e9-876e-4fff-8e05-9a637865cbac">2.4.2 Progressive GAN</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#bea8ea9d-f913-410f-afc2-e24951c5fbcd">2.4.3 The first GAN</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f4c656f8-e6c8-4998-8c71-0bc4c5725682">2.4.4 BigGAN</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#00305e4f-b6ad-4995-88af-ba3f36bc8b39">3. Theory behind GAN</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#89b80233-1514-4a70-be33-c5e17a182520">4. Tips for training GAN</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3b6283bf-51cd-4e54-b03a-5cd802648857">4.1 JS Divergence 特性</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#c71cbd7b-5930-4e72-85f9-a9ceeddbac48">4.1.1 結合 JS Divergence</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#79a4697a-48b7-4c15-ab25-84aba043cf5d">4.2 Wasserstein distance（WGAN）</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#2651b6aa-68d6-4f9c-a3fd-e37eed0d2eb8">4.2.1 Wasserstein 的計算</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b6a5d89d-621f-4240-85e0-bb29dbb0fc2f">4.3 Train GAN 的困難之處</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c877b88e-f951-425d-ac1d-929f365f0175">4.4 More Tips</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#3ae22cd2-df3f-47d2-be37-c0c90d6cf0f9">5. GAN for sequence generation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#04be8f7b-856c-4904-983d-2bcebd4e9f50">5.1 ScrachGAN：<em><a href="https://arxiv.org/abs/1905.09922">Train Language GANs Form Scrach</a></em></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#01a9b241-8e54-4bdd-b5d0-6d912f043353">6. Learn More</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#dcff6c57-1575-4e76-bd94-392d6038c15b">7. Evaluation of Generation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#19b3a6cb-fe75-4721-82a7-ab4bb6e4d336">7.1 Quality（對單張圖片）</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#dbc6f73d-ec28-4850-b856-75fed46c559a">7.2 Diversity（對所有圖片）</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#40b8a1a1-c3fa-49d6-935c-5b7b85bacc01">7.2.1 Mode Collapse</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f881d53b-8710-45da-920b-525ccdd0a7d4">7.2.2 Mode Dropping</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#6fe44ea0-217b-4392-80f6-b72b21807c81">7.2.3 評估 diversity</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a02559a0-d280-45c9-890d-1cfd5ef242af">7.3 Fréchet Inception Distance（FID）</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b1288b1f-296a-43e9-b563-527a8a9d9ed9">7.4 不希望 GAN 有記憶性</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2818e01d-f4ca-4274-a3be-19db3e5fdc7c">7.5 更多 Evaluation 方法</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#b31991ba-0c75-4cf6-8de7-840a432735cb">8. Conditional Generation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#77838ee9-b4ed-470d-a78c-32ca57874b58">8.1 Case 1：Text-to-Image </a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#4ff9094f-92b5-493a-a0a2-dc10291dc27e">8.1.1 如何訓練 Discriminator</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#032f5adb-479c-45ec-bf97-cfec4ac1d47a">8.2 Case 2：Image Translation（pix2pix）</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#310b370f-505f-4333-ba3e-8bc1c24e68d9">8.3 Case 3：Sound-to-Image</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#37eeedf9-9462-4f41-bd89-da3417984e69">8.4 Case 4：產生會動的圖像</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#7358ca93-3375-4370-8347-a2e79ec7a64e">9. Learning from Unpaired Data</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#017147ea-1bf0-4cee-896d-3573ab0f5136">9.1 影像風格轉換</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#00b25712-76a5-495f-8edb-dfa0c06ce6ce">9.2 <a href="https://arxiv.org/abs/1703.10593">Cycle GAN</a></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#326e5119-ee27-4bf8-a094-00d27b51f8bb">9.3 More style-transfer GAN</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#cfe7496e-1c36-452b-8c79-93083b20cb55">9.4 More Cases</a></div></nav><h1 id="1f62f0f0-09b2-4f48-b142-fa2eb2d1599d" class="">1. <strong>基本概念</strong></h1><p id="e144b774-ba7c-4f6c-8fba-1e0c90269adc" class="">輸入 neural network 的除 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 以外，還有一個<strong>從某一簡單的（已知）分布中隨機採樣</strong>得到的一個 random 的 variable，其中這個  neural network 就是 <strong>generator</strong></p><figure id="9065902b-8cd7-4877-b4cf-763f7f4a5069" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/0.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/0.png"/></a></figure><p id="b0773273-12fa-4b1a-a7c2-a17251e52435" class="">使用的 simple distribution 如：Gaussian distribution、Uniform distribution 等等</p><p id="ec9049f0-4190-4409-aa61-bc113718dbe0" class=""><strong>方法：</strong></p><ul id="11744bed-6fbe-486d-952e-a3aafc4e3298" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">x,z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> 兩個向量直接接起來，變成一個比較長的向量作為 network 的 input</li></ul><ul id="23081065-cb5c-4b6d-8472-3b9d184ae929" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 跟 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> 長度一樣，直接相加以後做為 network 的 input</li></ul><p id="889bbde1-fa9f-4732-abe9-b6b72bf62bdb" class=""><strong>注意：</strong></p><p id="43983c9f-bfd8-46ad-892a-9f94b4737480" class=""><strong>從 network 輸出的也將是一個分布</strong></p><figure id="a46e187e-f73b-47ed-a52c-5092ec3ee932" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/1.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/1.png"/></a></figure><figure id="4ce34a25-c2a8-4fdb-87cc-a2fc50738965" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/2.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/2.png"/></a></figure><p id="25c85ca1-9395-4152-9974-c7a7b933dc32" class="">目的是希望模型的輸出是 creative，如繪畫、聊天機器人等等</p><p id="05b906cb-7ee4-4492-a299-f928bb72f998" class="">
</p><h1 id="80372bef-4cff-4ace-ac49-78f9a0136956" class="">2. Generative Adversarial Network<strong>（GAN）</strong></h1><h2 id="68a63857-117d-4d1a-be3f-6c7b9e2f2275" class="">2.1 Unconditional Generation</h2><p id="cb1f86cd-07e6-4b8d-9520-7240b7e81979" class="">不考慮 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>，只先單純考慮從 simple distribution 採樣出來的 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span></p><figure id="03f1eda2-2a3a-4507-bd4c-067d2cf43f18" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/3.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/3.png"/></a></figure><p id="d67d9be6-f760-4263-a516-43f17d786015" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> 是從一個 normal distribution 裡 sample 出來的向量，通常會是一個 <strong>low-dimensional 的向量</strong>，而一張圖片就是一個非常高維的向量，所以 <strong>generator 實際上做的事情就是產生一個非常高維的向量</strong>，<strong>當輸入的向量不同（不同的 </strong><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span><strong>），輸出就會跟著改變</strong></p><p id="1db5e8e7-ad27-4775-b972-3facb4b9514b" class=""><strong>注意：</strong></p><p id="05dfa357-007f-446b-8392-ad73e3a08c45" class="">所選擇的不同 z 的 distribution 之間的差異並沒有非常大，但 generator 會想辦法<strong>把此簡單的 distribution 對應到一個複雜的 distribution</strong></p><h2 id="282786b4-7c98-4399-8e5a-98ce030fd735" class="">2.2 Discriminator</h2><p id="25bc2e11-8e70-4401-8e1e-49675af24c38" class="">discriminator 也是一個 neural network，其中裡面的架構可以自己設計，例如可以使用 CNN、Transformer 等等</p><figure id="e3f313c9-ddc9-4de1-b130-739236059204" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/4.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/4.png"/></a></figure><p id="55e4692d-2c0f-44ae-bbc0-dcd3a6f96f29" class="">把 generator 的輸出（一個高維向量）輸入到 discriminator，discriminator 會產生一個數字 scalar，<strong>越大代表 generator 的輸出越真實越合理</strong></p><h2 id="06ea5c7f-2b46-4165-bf49-48a0b041646b" class="">2.3 Algorithm</h2><p id="96d915cc-45e6-44a0-9613-cdd0e7ebbe19" class=""><strong>步驟：</strong></p><ol type="1" id="c7bda7a4-8c43-4324-b363-337d4cd5d5fe" class="numbered-list" start="1"><li>初始化 generator 與 discriminator</li></ol><ol type="1" id="c432c9b2-4df9-445f-a032-74e2c58f1a31" class="numbered-list" start="2"><li>固定 generator G，更新 discriminator D<figure id="1c6d813f-bb85-442e-885a-ec3d3cf71fe6" class="image" style="text-align:center"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/5.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/5.png"/></a></figure></li></ol><ol type="1" id="20112166-76ad-4102-a2cf-fed0fa2b9d64" class="numbered-list" start="3"><li>固定 discriminator D，更新 generator G<figure id="440742e5-1bc3-4a30-b58a-e090a9ff6ddc" class="image" style="text-align:center"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/6.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/6.png"/></a><figcaption>目標是希望 discriminator 產生的 scalar 越高越好</figcaption></figure></li></ol><ol type="1" id="741605c2-3310-4981-a40c-34974bda2c07" class="numbered-list" start="4"><li>重複步驟 2. 和 3.</li></ol><p id="e3adf6cb-c46a-46ac-939f-65ad5031157b" class=""><strong>注意：</strong></p><ul id="46107b40-0659-47b5-a2ab-b2d78767c514" class="bulleted-list"><li style="list-style-type:disc">generator 的參數是隨機初始化的，例如從高斯分布中 random sample 一堆 vector 丟到 generator，起初一些圖片會跟正常的二次元人物非常的不像</li></ul><ul id="5ea3a055-457d-4ced-bc78-5405fe588c9f" class="bulleted-list"><li style="list-style-type:disc">對於 discriminator 來說，這就是一個分類或是回歸問題。需要拿真正的二次元人物頭像跟 generator 產生出來的結果，去訓練 discriminator 來分辨他們的差異<ul id="b2b6eb9b-8fd5-4074-9a27-2a12547d34a6" class="bulleted-list"><li style="list-style-type:circle">若視作分類問題，就把真正的人臉當作類別 1，generator 產生出來的圖片當作類別 2，然後訓練一個 classifier</li></ul><ul id="5118bcc3-dae3-4e17-a20f-9d9e1ee4ccaa" class="bulleted-list"><li style="list-style-type:circle">若視作回歸問題，教 discriminator 看到真實二次元人臉圖片輸出 1，看到生成的圖片輸出 0</li></ul></li></ul><h2 id="5faa094e-b15c-4c38-91bf-824a4585cf09" class="">2.4 實例</h2><h3 id="959d1f07-d859-4500-9d71-cad2dd366cb2" class="">2.4.1 Anime Face Generation</h3><figure id="cf9f2681-f8e8-4ae3-af64-41a82558bcee" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/7.png"><img style="width:320.97222900390625px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/7.png"/></a></figure><h3 id="3413c9e9-876e-4fff-8e05-9a637865cbac" class="">2.4.2 Progressive GAN</h3><p id="ff6a672f-3438-4a72-8f98-7f20472f22df" class="">generator 輸入一個簡單向量，輸出一張高維的向量（圖片）。把輸入的向量做內插 interpolation，可以看到兩張圖片之間連續的變化</p><figure id="86115c4e-8751-43e1-892b-2fa5cb27d54b" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/8.png"><img style="width:336px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/8.png"/></a></figure><h3 id="bea8ea9d-f913-410f-afc2-e24951c5fbcd" class="">2.4.3 The first GAN</h3><p id="9c22ecfe-6c4d-41d2-9113-c69c8cc0d1f0" class=""><em><a href="https://arxiv.org/abs/1406.2661">Generative Adversarial Networks</a></em></p><h3 id="f4c656f8-e6c8-4998-8c71-0bc4c5725682" class="">2.4.4 BigGAN</h3><p id="ac2617eb-5de0-4990-80e5-e1b59401c4e8" class=""><em><a href="https://arxiv.org/abs/1809.11096">Large Scale GAN Training for High Fidelity Natural Image Synthesis</a></em></p><p id="8bf8308e-2b02-4923-aa7a-68644fff57f8" class="">
</p><h1 id="00305e4f-b6ad-4995-88af-ba3f36bc8b39" class="">3. Theory behind GAN</h1><p id="4b023946-aa19-417e-bff8-48ccb0268091" class="">有一個 generator，輸入許多從 normal distribution 採樣得到的向量，會輸出一個覆雜的 distribution，稱為 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>；而有一堆的真正的 data 也形成了另外一個 distribution，稱為 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>，期待 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><strong> 跟 </strong><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><strong> 越接近越好</strong></p><figure id="6757eef5-d949-4917-9d21-859a68176d74" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/9.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/9.png"/></a></figure><p id="d67a7e22-6b75-4e14-8792-7c862c37ddbc" class="">從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> sample 出一些 data，並借助 discriminator 計算 divergence 衡量 distribution 之間的距離</p><figure id="cd96e671-ed06-43cd-9c41-cad9847eb131" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/10.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/10.png"/></a></figure><p id="7a824da8-cd16-4ff5-bd6f-b01f58534ce9" class="">訓練 discriminator，希望看到 <strong>real data 就給比較高的分數</strong>，看到 <strong>generator 的 data 就給比較低的分數</strong></p><figure id="411205d5-8df2-4037-a851-e30cbc629da3" class="image" style="text-align:center"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/11.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/11.png"/></a></figure><p id="0eee8581-e1c7-4330-888e-915e5ec9e720" class=""><strong>寫成公式：</strong><div class="indented"><p id="dc07cbbd-d760-4f8f-98ae-bfe92f688116" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>y</mi><mo>∼</mo><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow></msub><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E_{y\sim P_{data}}[logD(y)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)]</span></span></span></span></span><span>﻿</span></span>：從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 裡面 sample 出來的 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 經過 discriminator 得到分數，再取 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">logD(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><p id="e14f3ccc-4be4-4db3-8fe1-98ab172fdfd9" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>y</mi><mo>∼</mo><msub><mi>P</mi><mi>G</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E_{y\sim P_G}[log(1-D(y))]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">))]</span></span></span></span></span><span>﻿</span></span>：從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 裡面 sample 出來的 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 經過 discriminator 得到分數，再取 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">log(1-D(y))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">))</span></span></span></span></span><span>﻿</span></span></p><figure id="8cc3da3d-cf4c-46fe-984b-29fb2a00d430" class="image" style="text-align:center"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/12.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/12.png"/></a></figure></div></p><p id="c0071030-e80d-4328-a650-5cdd5a202568" class=""><strong>目標：</strong></p><p id="33cf636d-aca7-4c33-bdba-f6f89b90ebf9" class="">希望 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>y</mi><mo>∼</mo><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow></msub><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E_{y\sim P_{data}}[logD(y)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)]</span></span></span></span></span><span>﻿</span></span> 越高越好，希望 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>y</mi><mo>∼</mo><msub><mi>P</mi><mi>G</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E_{y\sim P_G}[log(1-D(y))]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">))]</span></span></span></span></span><span>﻿</span></span> 越低越好<div class="indented"><figure id="e7c7950d-4cd0-419e-bd28-7f979f9710cc" class="image" style="text-align:center"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/13.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/13.png"/></a></figure></div></p><p id="44d674c7-cc32-412d-86ce-eadf560b8cab" class=""><strong>注意：</strong></p><p id="536b8c79-7f61-4a86-8c30-fa5f87fb4939" class="">不一定要把 objective function 寫成這個樣子，它可以有其他的寫法，最早年之所以寫成這個樣子，是為了要把 discriminator 跟 binary classification 扯上關係</p><p id="27541e25-3a54-46e5-99b3-8b039387aa8b" class=""><strong>直觀理解：</strong></p><figure id="a33aadf8-b6b1-445b-a926-ffb0abe91823" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/14.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/14.png"/></a></figure><ul id="b1cdbcb4-ce13-4be1-a87e-5c9d85232dd1" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 跟 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 很像，它們差距沒有很大時，discriminator 就是在訓練一個 binary classifier，這個問題很難，所以在解此 optimization problem 就沒有辦法讓二元分類器訓練任務的損失函數（cross entropy）很小，也就是沒有辦法讓 objective 的值 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span><span>﻿</span></span> 非常大 ⇒ <strong>小的 divergence，對應 </strong><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span><span>﻿</span></span><strong> 的 maximum 的值就比較小</strong></li></ul><ul id="33d41ac3-0dd2-44e1-a267-5320aa427539" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 跟 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 很不像，divergence 值很大，此時這個二元分類器就可以很輕易地分開，訓練的損失函數很小，也就是目標函數 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span><span>﻿</span></span> 的值很大 ⇒ <strong>大的 divergence，對應 </strong><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span><span>﻿</span></span><strong> 的Maximum 的值就比較大</strong></li></ul><p id="01137a29-e37c-4bec-a51f-e10fc9e5eac8" class=""><strong>結論：</strong></p><p id="f43b8226-3fca-41d8-94b6-954efd69732d" class="">要 minimize 的是 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 跟 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 的 divergence，但要計算 divergence 很困難，所以藉由 discriminator 來找出一個 objective function 要去 maximize，但發現要 maximize 的 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span><span>﻿</span></span> 跟 JS divergence 有關聯，所以直接把 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>i</mi><mi>v</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Div(D,G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>  替換成 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>D</mi></munder><mi>V</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathop{max}\limits_{D}V(D,G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4943em;vertical-align:-0.7443em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.3557em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7443em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><figure id="b439cc83-d9dc-49e7-a072-a3963b1528b7" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/15.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/15.png"/></a></figure><figure id="aa28b88b-1647-4b13-b587-48b3396a68f1" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/16.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/16.png"/></a></figure><p id="9ee369e0-b7f5-4fc8-b5f9-8760228470b0" class="">不同的 obejctive function 與 divergence 之間的對應關係</p><figure id="7631c458-1bc2-4a0c-89c7-f9a6e95ec323" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/17.png"><img style="width:624px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/17.png"/></a><figcaption>可參考：<a href="https://arxiv.org/abs/1606.00709"><em>f-GAN: Training Generative Neural Samplers using Variational Divergence Minimization</em></a></figcaption></figure><p id="fba247c9-c44d-4396-b8ca-6ea825b51391" class="">
</p><h1 id="89b80233-1514-4a70-be33-c5e17a182520" class="">4. Tips for training GAN</h1><h2 id="3b6283bf-51cd-4e54-b03a-5cd802648857" class="">4.1 JS Divergence 特性</h2><ol type="1" id="e4bea36d-f097-4879-bbb9-b8b6b81cabd6" class="numbered-list" start="1"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 的分布和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 的分佈重疊的部分非常小</li></ol><figure id="75b63bc1-e73b-4f42-80a8-c113d474ad15" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/18.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/18.png"/></a></figure><p id="5c8f7307-cef9-403b-9681-86391552fac9" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 跟 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 它們都是要產生圖片的。圖片是高維空間裡面的一個非常狹窄的低維的 manifold。高維空間中隨便 Sample 一個點都不是圖片，只有非常小的範圍 sample 出來會是圖片。再者 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 跟 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 都是 low dimensional 的 manifold，除非剛好重合，不然它們相交的範圍幾乎是可以忽略的</p><p id="2dcfff05-e619-4d32-a572-a7d4a5f617c1" class=""><strong>* Manifolds 是可以局部歐幾里德空間化的一個拓撲空間，是歐幾里德空間中的曲線、曲面等概念的推廣</strong></p><ol type="1" id="e9223a2f-abcf-4c09-b522-2a87e1742fd9" class="numbered-list" start="2"><li>基於 sample 的 divergence 衡量具有局限性 ⇒ 難以採樣到“重疊的點”</li></ol><figure id="e9a52d46-b17a-4111-bad7-acf4f7a9545a" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/19.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/19.png"/></a></figure><p id="01bee27e-63f9-4126-b0d3-04d5ddfee94f" class="">由於我們無法得知 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 與 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 的真實情況，只能通過 sample 來進行推斷。對於 discriminator 來說，如果 Sample 的點不夠多、不夠密，就算這兩個 distribution 實際上有重疊，也無法判斷出來</p><h3 id="c71cbd7b-5930-4e72-85f9-a9ceeddbac48" class="">4.1.1 結合 JS Divergence</h3><figure id="891c850f-009d-4d5c-b8c3-1a6d572f590a" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/20.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/20.png"/></a></figure><p id="8d7ba6b0-d182-4394-b44a-ccb3c7bd0455" class="">JS Divergence 的特性是兩個沒有重疊的分布 JS Divergence 算出來的值恆為 Log2，無法衡量這類（沒有重疊的）分布之間的關係</p><h2 id="79a4697a-48b7-4c15-ab25-84aba043cf5d" class="">4.2 Wasserstein distance（WGAN）</h2><p id="90a44b3b-9ce1-49dc-bf5f-9cbf69fb435e" class=""><strong>使用 Wasserstein distance 代替 JS Divergence。</strong>“推土”距離的最小值 ⇒ 必須窮舉/優化問題</p><figure id="009d382e-dee2-4764-907b-09a34f99b7fc" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/21.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/21.png"/></a></figure><p id="1566af16-ab19-4f22-840e-6ebfe107062d" class="">用從 P 移到 Q 的位置的距離衡量兩個分布 P 與 Q 之間的差異。Wasserstein Distance 的作用<strong>能夠分辨出沒有重疊 distribution 的差距</strong>，實現兩個分布從毫不相關到逐漸相關</p><figure id="0739e838-bc7c-4e98-82ab-2b164b33bc07" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/22.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/22.png"/></a></figure><h3 id="2651b6aa-68d6-4f9c-a3fd-e37eed0d2eb8" class="">4.2.1 Wasserstein 的計算</h3><p id="2a14be5a-89a4-4209-8cfe-26846b323c03" class="">目標是要 <strong>maximize</strong> 這個 objective function：<div class="indented"><p id="bfac071b-9b77-4393-b7db-6f7cdd011d65" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 如果是從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{data}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 來的，計算 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> 的<strong>期望值，希望越大越好</strong></p><p id="30c4fbac-2135-4610-b3d5-bd48a78def06" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 如果是從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">P_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 來的，計算 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> 的<strong>期望值，但是前面乘上一個負號，所以希望越小越好</strong></p></div></p><figure id="76d47563-4c5d-464c-a284-edc99169c2dc" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/23.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/23.png"/></a></figure><p id="d9e20a09-faaa-4f5c-8a7b-723829f7bc03" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span><span>﻿</span></span> 必須要是一個足夠平滑的 function，不可以是變動很劇烈的 function。即使兩個分布<strong>沒有重疊</strong>時，也不會出現“過於劇烈”的 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span><span>﻿</span></span>，可以<strong>保證收斂性</strong> ⇒ <strong>避免了 JS Divergence 出現的問題</strong></p><figure id="793d09b1-c383-4cbd-a8e1-ce9195279a7a" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/24.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/24.png"/></a></figure><p id="2b8e9c97-c927-47d6-968f-fe3ce18d4862" class=""><strong>問題：</strong>要如何讓 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span><span>﻿</span></span> 符合 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>L</mi><mi>i</mi><mi>p</mi><mi>s</mi><mi>c</mi><mi>h</mi><mi>i</mi><mi>t</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">1-Lipschitz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">i</span><span class="mord mathnormal">p</span><span class="mord mathnormal">sc</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> 的限制？</p><p id="1dda4c93-7dda-4bff-aec4-efda3af8795d" class=""><strong>方法：</strong></p><ol type="1" id="ce310147-b955-43c8-bcd2-395ea193bdb5" class="numbered-list" start="1"><li><strong>限制參數大小<br/>但</strong>並不一定能夠讓 discriminator 符合 1-Lipschitz Function</li></ol><figure id="c549be70-be1e-46a4-ba4a-058c0b7142d5" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/25.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/25.png"/></a></figure><ol type="1" id="e40d939a-a4b9-4654-8b05-c77b9a672128" class="numbered-list" start="2"><li><strong>Gradient Penalty<br/></strong>在 real data 取一個 sample，fake data 取一個 sample，兩點連線中間再取一個 sample，要求這個點它的 gradient 要接近 1</li></ol><figure id="9a872a05-e291-4699-82d4-4ab25d9ec4bd" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/26.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/26.png"/></a><figcaption>可參考：<a href="https://arxiv.org/abs/1704.00028"><em>Improved Training of Wasserstein GANs</em></a></figcaption></figure><ol type="1" id="4a300025-0ba0-44b5-a060-c5d38a1cfc47" class="numbered-list" start="3"><li><strong>Spectral Normalization<br/></strong>可以<strong>保證符合 1-Lipschitz</strong>，可參考：<em><a href="https://arxiv.org/abs/1802.05957">Spectral Normalization for Generative Adversarial Networks</a></em></li></ol><h2 id="b6a5d89d-621f-4240-85e0-bb29dbb0fc2f" class="">4.3 Train GAN 的困難之處</h2><p id="417a9fee-d36c-4a44-a8dc-5fa68c48f3cf" class=""><strong>generator 跟 discriminator 是互相砥礪才能互相成長</strong>，只要其中一者發生什麼問題停止訓練，另外一者就會跟著停下訓練，如果有一次loss沒有下降，那整個訓練過程都有可能出現問題。所以<strong>需要保證二者的 loss 在這一過程中不斷下降</strong></p><figure id="e674ec73-2cdb-4adf-aafb-12031d34de7c" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/27.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/27.png"/></a></figure><h2 id="c877b88e-f951-425d-ac1d-929f365f0175" class="">4.4 More Tips</h2><ul id="458b8427-2554-4e46-b3ed-d9370a618dcc" class="bulleted-list"><li style="list-style-type:disc"><em><a href="https://github.com/soumith/ganhacks">Tips from Soumith</a></em></li></ul><ul id="8ba2edf7-6639-4bca-a576-fd5be9dec346" class="bulleted-list"><li style="list-style-type:disc"><em><a href="https://arxiv.org/abs/1511.06434">Tips in DCGAN: Guideline for network architecture design for image generation</a></em></li></ul><ul id="1a44e23e-e369-490c-a9e1-3c0cab4306ed" class="bulleted-list"><li style="list-style-type:disc"><em><a href="https://arxiv.org/abs/1606.03498">Improved techniques for training GANs</a></em></li></ul><ul id="5de0f75f-fcb9-4ce1-bc09-a77252f09266" class="bulleted-list"><li style="list-style-type:disc"><em><a href="https://arxiv.org/abs/1809.11096">Tips from BigGAN</a></em></li></ul><p id="72dc65d7-937d-4a67-8af0-1c253ea4b604" class="">
</p><h1 id="3ae22cd2-df3f-47d2-be37-c0c90d6cf0f9" class="">5. GAN for sequence generation</h1><p id="aa79a5ef-eb30-4284-964a-a4baf998fd49" class="">利用 GAN 來生成文字，decoder 就是 generator，目標是騙過 discriminator</p><figure id="864ac781-6882-42c9-9937-9f6865d3005e" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/28.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/28.png"/></a></figure><p id="4028f06d-7411-4c2a-83bf-a44bfcc4f306" class=""><strong>問題：</strong></p><p id="1755768e-1f10-4fc1-a679-343ee7d36fe1" class="">要用 gradient descent 去訓練 decoder 讓 discriminator 輸出分數越大越好，但會發現<strong>做不到</strong></p><p id="bb6e29f5-993c-4ebb-b3e3-e893f255fefa" class=""><strong>原因：</strong></p><p id="f1fb43d2-85cd-4ce0-83ac-5fded003f7e5" class="">由於取了max，這一運算使得 discriminator 的 score 對 decoder 參數不可微分，也就不能做 gradient descent</p><p id="cb1f739b-7223-49a6-9dd9-511be8823949" class=""><strong>解決：</strong></p><p id="8cf203b5-2346-4782-af38-b804558f92e3" class="">不能用 gradient descent 的問題，可以使用 <strong>RL</strong> 硬訓練或是使用 <strong>pretrain</strong></p><h3 id="04be8f7b-856c-4904-983d-2bcebd4e9f50" class="">5.1 ScrachGAN：<em><a href="https://arxiv.org/abs/1905.09922">Train Language GANs Form Scrach</a></em></h3><p id="37eaf9e8-de6a-4268-97a5-75d0261d7390" class="">直接從隨機的初始化參數開始訓練 generator，然後讓 generator 可以產生文字，該模型最關鍵的就是爆調超參數跟一大堆的 tips</p><figure id="faeb8e9e-a503-4880-b967-65dc8e9ce5f0" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/29.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/29.png"/></a></figure><p id="7c1bd230-500d-4af5-80d0-786a6b14b042" class="">
</p><h1 id="01a9b241-8e54-4bdd-b5d0-6d912f043353" class="">6. Learn More</h1><div id="5ba0cb31-eb02-4c6b-8af1-a571e897120b" class="column-list"><div id="750ddcd7-fa42-4c8c-b6cb-11c41a5084d8" style="width:50%" class="column"><figure id="3c612732-256b-4092-bdb7-e89491b20ad6" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/30.png"><img style="width:336px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/30.png"/></a><figcaption><a href="https://youtube.com/playlist?list=PLJV_el3uVTsMq6JEFPW35BCiOQTsoqwNw">https://www.youtube.com/playlist?list=PLJV_el3uVTsMq6JEFPW35BCiOQTsoqwNw</a></figcaption></figure></div><div id="dd523245-1cb0-460f-bd81-d7ed3b8f534f" style="width:50%" class="column"><figure id="033dad9c-831c-4c0f-bf59-59b739d9e5ba" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/31.png"><img style="width:336px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/31.png"/></a><figcaption><a href="https://youtu.be/8zomhgKrsmQ">https://youtu.be/8zomhgKrsmQ</a><br/><a href="https://youtu.be/uXY18nzdSsM">https://youtu.be/uXY18nzdSsM</a></figcaption></figure></div></div><p id="eb724b7a-fdc6-47a1-8005-b63cb3807420" class=""><strong>supervised learning 訓練生成式模型：</strong></p><p id="f336b5d5-a8ff-43bb-94e5-f58cf8933461" class="">每一個圖片配一個從 gaussian distribution sample 出來的 vector，訓練一個 network，輸入一個 vector 輸出就是它對應的圖片，把對應的圖片當做訓練目標訓練</p><figure id="c51f455a-9614-48e9-8b63-53166e4dc58d" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/32.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/32.png"/></a></figure><p id="cf130f65-3259-451d-a5cc-11286d69bcdf" class="">Generative Latent Optimization (GLO)：<em><a href="https://arxiv.org/abs/1707.05776">Optimizing the Latent Space of Generative Networks</a></em></p><p id="8aeae988-805b-448b-b68e-628238f9e15a" class="">Gradient Origin Networks：<em><a href="https://arxiv.org/abs/2007.02798">Gradient Origin Networks</a></em></p><p id="f4e4dd19-4fc7-4f81-b35e-08e83d578c07" class="">
</p><h1 id="dcff6c57-1575-4e76-bd94-392d6038c15b" class="">7. Evaluation of Generation</h1><ul id="ca30d1a0-f38b-419e-a61a-e5267f9b070c" class="bulleted-list"><li style="list-style-type:disc">直覺的方法：人眼來看，但不客觀且不穩定</li></ul><ul id="29c2c1bf-7735-4d26-9b55-e80eb4175844" class="bulleted-list"><li style="list-style-type:disc">自動化方法：借助影像辨識系統</li></ul><h2 id="19b3a6cb-fe75-4721-82a7-ab4bb6e4d336" class="">7.1 Quality（對單張圖片）</h2><figure id="de46809c-888a-47f9-b114-2091420bfc69" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/33.png"><img style="width:576px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/33.png"/></a></figure><p id="2bdadb04-36d6-42ac-b6ea-c5643d173e79" class="">將圖片輸入影像辨識系統，若<strong>機率分布越集中</strong>，說明產生的圖片能夠被影像分類系統很肯定地分辨出來，代表產生的<strong>圖片品質越好</strong>；反之若<strong>機率分布越平坦</strong>，代表產生的<strong>圖片品質低</strong></p><h2 id="dbc6f73d-ec28-4850-b856-75fed46c559a" class="">7.2 Diversity（對所有圖片）</h2><h3 id="40b8a1a1-c3fa-49d6-935c-5b7b85bacc01" class="">7.2.1 Mode Collapse</h3><p id="91fd5e82-e1f4-4643-ac5e-5678196714cd" class="">generator 輸出的分布局限在很小的範圍內</p><figure id="6734cff7-1668-4d8e-8ad8-a88d56b2ef4f" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/34.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/34.png"/></a></figure><h3 id="f881d53b-8710-45da-920b-525ccdd0a7d4" class="">7.2.2 Mode Dropping</h3><p id="f8608dd1-eca4-4a0f-a645-f07a56f68265" class="">訓練輸出的分布範圍較大，但沒有完全覆蓋真實數據分布（多樣性減小）</p><figure id="58aa734d-1aed-4ac5-9bfd-312dee671226" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/35.png"><img style="width:675.9722290039062px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/35.png"/></a></figure><h3 id="6fe44ea0-217b-4392-80f6-b72b21807c81" class="">7.2.3 評估 diversity</h3><p id="a6c1081b-b76e-483a-8a3b-ac7dd797a3a6" class="">把影像辨識系統對所有生成結果的輸出平均起來</p><div id="54b3187c-ddf9-472f-85ab-aa71f736aa1f" class="column-list"><div id="829b0732-1ff6-4ad7-b6f1-c2a3648afe04" style="width:50%" class="column"><p id="f1b59463-5a76-4f1e-b8d7-2621b2eb0de5" class="">平均分布<strong>集中</strong>，表示<strong>多樣性低</strong></p><figure id="065d1169-be76-4dfc-9c78-5588139cda9e" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/36.png"><img style="width:336px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/36.png"/></a></figure></div><div id="63511522-4da4-48b7-8372-14a13c0c245b" style="width:50%" class="column"><p id="9e94ce7a-e66b-49b1-ac5d-95d75afb5d2c" class="">平均分布<strong>均勻</strong>，表示<strong>多樣性高</strong></p><figure id="689efb47-57e6-4a04-a8d0-961e9dd6a7d9" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/37.png"><img style="width:288px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/37.png"/></a></figure><p id="e286a4ed-1e2d-4e79-8eed-b855c1917487" class="">Inception Score（IS）<br/>⇒ 基於 CNN 的 Inception network。將生成結果放進 Inception network，通過輸出的分布結果來衡量。如果 quality 高且 diversity 又大，那麼 Inception Score 就會比較大</p></div></div><h2 id="a02559a0-d280-45c9-890d-1cfd5ef242af" class="">7.3 Fréchet Inception Distance（FID）</h2><p id="2211df6c-b30d-489c-a170-a868ee1cc7dd" class="">現今較<strong>常用的評估方法</strong>。將圖片送入 Inception Network，取 softmax 之前的 hidden layer 輸出的向量，來代表這張圖片，利用這個向量來衡量兩個分布之間的關係</p><figure id="c14838aa-9371-4c38-8cd0-38322c446207" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/38.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/38.png"/></a></figure><p id="48b73c6e-6225-496f-ad91-314743b1bdec" class="">假設真實數據和生成數據的兩個分布，都是從高斯分布中抽樣得到的，計算兩個高斯分布之間的 Fréchet Distance，<strong>越小代表分布越接近，圖片品質越高</strong></p><p id="4b97454c-0a21-43ec-8663-59142b7bc9b5" class=""><strong>問題：</strong></p><ul id="25997809-9796-46ab-b88e-0b4f869a6cb3" class="bulleted-list"><li style="list-style-type:disc">將任意分布都視為高斯分布會有問題</li></ul><ul id="3d362636-fd0e-4bfd-bb02-8933dbc58db2" class="bulleted-list"><li style="list-style-type:disc">因計算 FID 需要大量的採樣，所以計算量大</li></ul><h2 id="b1288b1f-296a-43e9-b563-527a8a9d9ed9" class="">7.4 不希望 GAN 有記憶性</h2><p id="71837d68-7557-4b07-8b1e-1fb8fbd1dddf" class="">訓練了一個 generator，它產生出來的 data 跟真實資料一模一樣，但這實際上並無意義</p><div id="94443c4c-2032-49b3-a757-59540121f485" class="column-list"><div id="1865d30a-8af3-4145-a460-4cbda252eaf8" style="width:50%" class="column"><figure id="072729b8-95b7-4048-867a-ffabf2eacfac" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/39.png"><img style="width:330.0138854980469px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/39.png"/></a></figure></div><div id="a28cc7ad-2783-4361-be26-2d6ebaae7f85" style="width:50%" class="column"><figure id="65e4e471-4224-4f12-8ab1-2530eea426fe" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/40.png"><img style="width:330.0555725097656px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/40.png"/></a></figure></div></div><p id="e7941e64-abdc-4c72-b465-8683ef9357c0" class="">或是只學會了左右反轉，也沒有意義</p><figure id="ef9f6ea9-5c0d-4cf4-9a7f-e63721963408" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/41.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/41.png"/></a></figure><h2 id="2818e01d-f4ca-4274-a3be-19db3e5fdc7c" class="">7.5 更多 Evaluation 方法</h2><figure id="4b55a399-c8df-43d7-b561-2a44797482a4" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/42.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/42.png"/></a><figcaption>可參考：<a href="https://arxiv.org/abs/1802.03446"><em>Pros and Cons of GAN Evaluation Measures</em></a></figcaption></figure><p id="dbe2d3b9-27d2-4c6e-a861-34eed8215b29" class="">
</p><h1 id="b31991ba-0c75-4cf6-8de7-840a432735cb" class="">8. Conditional Generation</h1><p id="7522494d-ee03-4222-bb01-6d6e4bf1f6c9" class="">在 <a href="https://www.notion.so/06-Generative-Adversarial-Network-GAN-3eef1d4d34384ea596d6be37eb429a25?pvs=21">2.1 Unconditional Generation</a> 不考慮 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>，而 Conditional Generation 則將 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 考慮進去</p><h2 id="77838ee9-b4ed-470d-a78c-32ca57874b58" class="">8.1 Case 1：Text-to-Image </h2><p id="acadc60b-05c6-48de-b452-bec036b65678" class="">操控 generator 的輸出，給它 condition <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>，再從一個簡單分布中抽樣 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span>，讓 generator 根據 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> 來產生圖片 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span></p><figure id="e210b232-ebce-4219-8e51-4256d9dd2df0" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/43.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/43.png"/></a></figure><h3 id="4ff9094f-92b5-493a-a0a2-dc10291dc27e" class="">8.1.1 如何訓練 Discriminator</h3><p id="476316be-1884-45d2-a0d1-7b02c0f3ea6c" class="">discriminator 不再只輸入圖片 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span>，它還要輸入 condition <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>。一方面圖片要好，另外一方面圖片跟文字的敘述必須要相配，discriminator 才會給高分</p><figure id="da5f86f2-4d02-4d85-b466-52a46844a5e4" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/44.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/44.png"/></a></figure><p id="e0bd8fed-9680-42cc-bf74-239f057e9922" class="">需要有文字敘述和影像的成對資料來訓練 discriminator，所以一般而言 <strong>conditional GAN 要訓練都必須是要有有標註且成對的資料</strong>。匹配上就得高分，匹配不上就得低分</p><figure id="1ff04651-0ebe-46b0-92f5-7bba22e030bf" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/45.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/45.png"/></a></figure><h2 id="032f5adb-479c-45ec-bf97-cfec4ac1d47a" class="">8.2 Case 2：Image Translation（pix2pix）</h2><figure id="25ab5c92-6666-4627-8d6f-4fab16498be7" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/46.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/46.png"/></a></figure><figure id="beab2b7d-d3d3-43db-8452-bcd2d4207df9" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/47.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/47.png"/></a></figure><p id="9b202c58-ea64-4ebc-acf7-229fbd776186" class="">單純利用 supervised learning 訓練會<strong>造成輸出模糊</strong>，<strong>因為同樣的輸入可能對應到不一樣的輸出</strong>（同一個轉角，小精靈可能左轉也可能右轉，最後學到的就是同時左轉跟右轉）</p><p id="145eec8e-3328-464c-8993-590912fe4c70" class="">單純利用 GAN 產生出來的圖片雖比較真實，但是問題是它的想像力過度豐富，出現不該出現的東西</p><p id="e7c1dee9-81c0-4c76-b163-1de491de72c2" class="">⇒ 結合 <strong>GAN 跟 supervised learning</strong>，測試上就可以有比較好的結果</p><h2 id="310b370f-505f-4333-ba3e-8bc1c24e68d9" class="">8.3 Case 3：Sound-to-Image</h2><figure id="0496d6bb-9d05-46f1-8815-0fd1691c146a" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/48.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/48.png"/></a></figure><h2 id="37eeedf9-9462-4f41-bd89-da3417984e69" class="">8.4 Case 4：產生會動的圖像</h2><figure id="88f95afe-b3dc-434e-bf43-55a67d2a295d" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/49.png"><img style="width:528px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/49.png"/></a><figcaption>可參考：<a href="https://arxiv.org/abs/1905.08233"><em>Few-Shot Adversarial Learning of Realistic Neural Talking Head Models</em></a></figcaption></figure><p id="735a404d-3f7c-4fff-8b7b-4c639a41f10a" class="">
</p><h1 id="7358ca93-3375-4370-8347-a2e79ec7a64e" class="">9. Learning from Unpaired Data</h1><p id="3acbc523-c6ac-42dd-a7dc-00a643e10da3" class="">把 GAN 應用在 unsupervised learning 上，因為有時無法蒐集到成對的資料（稱為 unlabeled data）</p><figure id="8c6c4b3b-d95d-4fdb-84e9-b4bf6a1d83e2" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/50.png"><img style="width:384px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/50.png"/></a></figure><h2 id="017147ea-1bf0-4cee-896d-3573ab0f5136" class="">9.1 影像風格轉換</h2><figure id="0d044f2b-cc78-4abe-987b-23eabdccc4cc" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/51.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/51.png"/></a></figure><p id="fcc587d6-5aa6-4289-aa30-01d3d13769b5" class="">套用原來的方法，但這邊將 sample 的對象從一個 simple distribution 改為 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>，而 discriminater 利用 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 中的圖像做訓練，確保輸出圖片屬於 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span></p><figure id="9679c27a-72e5-4ba7-9080-6ea9a101f600" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/52.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/52.png"/></a></figure><h2 id="00b25712-76a5-495f-8edb-dfa0c06ce6ce" class="">9.2 <a href="https://arxiv.org/abs/1703.10593">Cycle GAN</a></h2><p id="ee376fca-2b54-49ac-b769-3042c0440070" class="">有一個循環，從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 到 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 在從 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 回到 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>，是一個 cycle 所以叫做 Cycle GAN。利用這種架構，強迫 generator 輸出的 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 圖片跟輸入的 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 圖片有一些關係</p><p id="e4e670d9-639a-4813-b365-c0e927a720e6" class="">增加第二個 generator，第一個 generator 的工作是把 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 轉成 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span>，第二個 generator 的工作是要把 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 還原回原來的 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>，而 discriminator 的工作仍然是要看第一個 generator 的輸出像不像是 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 的圖<div class="indented"><p id="62e43808-40d1-4a64-b2d3-d3e354c16c33" class="">
</p></div></p><figure id="bf0547fa-ef41-4564-a95a-fd0e660704c7" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/53.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/53.png"/></a></figure><p id="29c45890-10ea-45ab-9613-3fb2d40b2d5b" class="">Cycle GAN 可以是雙向的，給橘色的 generator domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 的圖片，讓它產生 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> 的圖片，然後輸入到藍色的 generator 還原回原來 domain <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> 的圖片</p><figure id="78f69bef-38ac-4e6c-9096-66f7fdf211a8" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/54.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/54.png"/></a></figure><h2 id="326e5119-ee27-4bf8-a094-00d27b51f8bb" class="">9.3 More style-transfer GAN</h2><p id="cdc4968e-7039-4dae-beff-8df802ad7d85" class=""><em><a href="https://arxiv.org/abs/1703.05192">Learning to Discover Cross-Domain Relations with Generative Adversarial Networks</a></em><strong>（Disco GAN）</strong></p><figure id="dda6a9c3-3319-4931-9f59-586d72416b08" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/55.png"><img style="width:480px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/55.png"/></a></figure><p id="4b62951d-f3d1-47b4-8b48-25d0776ccca1" class=""><em><a href="https://arxiv.org/abs/1704.02510">DualGAN: Unsupervised Dual Learning for Image-to-Image Translation</a></em><strong>（Dual GAN）</strong></p><figure id="4d55ffdb-db84-480d-9b56-e7a28014433e" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/56.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/56.png"/></a></figure><p id="7677ad84-19e0-4bf7-9041-9513c73d1240" class=""><em><a href="https://arxiv.org/abs/1711.09020">StarGAN: Unified Generative Adversarial Networks for Multi-Domain Image-to-Image Translation</a></em><em><br/></em><strong>（StarGAN，多種風格間做轉換）</strong></p><h2 id="cfe7496e-1c36-452b-8c79-93083b20cb55" class="">9.4 More Cases</h2><figure id="43b9d495-43f7-4c53-8a53-92f1c68378ae" class="image"><a href="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/57.png"><img style="width:432px" src="06-Generative%20Adversarial%20Network%EF%BC%88GAN%EF%BC%89/57.png"/></a></figure></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>